import{r as c,o as z,a0 as H,u as K,P as Q,a as w,X as Y,a9 as Z,c as ee,a1 as te,E as se,e as ae,g as oe,h as le,f as ne,R as re,k as v,l as T,p as a,q as n,m as e,s as h,T as ce,t as j,x as V,v as ie,A as d,aa as ue,ab as de,a6 as pe,a5 as _e}from"./index-8160da6b.js";import{f as me,g as fe}from"./el-image-viewer-21b4c183.js";import{_ as ge}from"./auth-container-a26b6d75.js";import{_ as ve,v as he}from"./captcha-f28fc6ad.js";import"./_plugin-vue_export-helper-b6a112e1.js";const ye={class:"flex-col login-p"},xe={style:{"margin-bottom":"40px"},class:"flex-center"},ke=e("h3",{class:"flex-1 login-p__title"},"\u6CE8\u518C",-1),we={class:"app-flex-left"},Ve={class:"app-flex-left"},Ce={class:"flex-1 flex-col justify-end login-p__btns"},be={key:0,class:"temp"},Ue=e("div",{class:"otherType"},[e("span",{class:"line"}),e("span",{class:"title"},"\u5176\u4ED6\u767B\u5F55\u65B9\u5F0F")],-1),qe={class:"loginPanel normalPanel"},Ee={class:"waiting panelContent"},Se={class:"wrp_code"},Te=e("div",{class:"info"},[e("div",{class:"status status_browser js_status js_wx_default_tip",id:"wx_default_tip"},[e("p",null,"\u4F7F\u7528\u5FAE\u4FE1\u626B\u4E00\u626B\u767B\u5F55")]),e("div",{class:"status status_succ js_status js_wx_after_scan",style:{display:"none"},id:"wx_after_scan"},[e("i",{class:"status_icon icon38_msg succ"}),e("div",{class:"status_txt"},[e("h4",null,"\u626B\u63CF\u6210\u529F"),e("p",null,"\u5728\u5FAE\u4FE1\u4E2D\u8F7B\u89E6\u5141\u8BB8\u5373\u53EF\u767B\u5F55")])]),e("div",{class:"status status_fail js_status js_wx_after_cancel",style:{display:"none"},id:"wx_after_cancel"},[e("i",{class:"status_icon icon38_msg warn"}),e("div",{class:"status_txt"},[e("h4",null,"\u4F60\u5DF2\u53D6\u6D88\u6B64\u6B21\u767B\u5F55"),e("p",null,"\u4F60\u53EF\u518D\u6B21\u626B\u63CF\u767B\u5F55\uFF0C\u6216\u5173\u95ED\u7A97\u53E3")])])],-1),B=60,Le={__name:"register",setup(je){const $=c(!0);z(()=>{document.title=`${H.title}-\u8D26\u53F7\u6CE8\u518C`});const y=K(),I=Q(),N=c(JSON.parse(localStorage.register_check).data),C=c(null),l=w({account:"",pass:"",phone:"",captcha:"",code:""}),R=w({pass:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}],phone:[{required:!0,message:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7",trigger:"blur"}]});let i="";const L=s=>{i=s.toUpperCase()};let p;const r=w({value:B,posting:!1,counting:!1}),F=Y(()=>r.counting?`${r.value} s\u53EF\u91CD\u53D1`:"\u53D1\u9001\u9A8C\u8BC1\u7801"),x=()=>{!p||(clearInterval(p),p=null)},P=()=>{x(),r.value=B,r.counting=!0,p=setInterval(()=>{const s=r.value-1;s>0?r.value=s:(x(),r.counting=!1)},1e3)};Z(()=>x());const u=c(!1),b=async()=>{if(!i){u.value=!0;return}if(!(r.posting||r.counting))if(l.captcha.toUpperCase()!=i){d({message:"\u8BF7\u5148\u8F93\u5165\u6B63\u786E\u7684\u56FE\u7247\u9A8C\u8BC1\u7801",type:"error"}),u.value=!0;return}else he(l.phone)?await ue(l.phone)&&(r.posting=!0,P()):d({message:"\u8BF7\u5148\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801",type:"error"})},A=async s=>{if(console.log(i,l.captcha),l.captcha.toUpperCase()!=i&&d({message:"\u8BF7\u5148\u8F93\u5165\u6B63\u786E\u7684\u56FE\u7247\u9A8C\u8BC1\u7801",type:"error"}),!(!s||!await s.validate())){d({message:"\u63D0\u4EA4\u4E2D...",type:"success"});try{const{data:m}=await de(l);console.log(m,"kjlk;l;"),y.push({path:"/login",replace:!0})}catch(m){}}},D=s=>{y.push({name:s,query:I.query})},U=c(""),q=c({random:""}),M=c(localStorage.getItem("isWechat")),_=c(!1),O=async()=>{const s=await me();s&&(U.value=s.data.code,q.value.random=s.data.random,_.value=!0,E())},E=async()=>{setTimeout(async()=>{const s=await fe({random:q.value.random});if(s){d({message:"\u767B\u5F55\u6210\u529F",type:"success"});const{setToken:t}=_e();t(s.data.token),W(s.data.token)}else _.value&&E()},1e3)},W=s=>{console.log("asdasd"),y.push({path:"/"})};return(s,t)=>{const m=ee,G=te,f=se,g=ae,k=oe,S=le,J=ne,X=re;return v(),T("div",null,[a(ge,null,{default:n(()=>[e("div",ye,[e("div",xe,[ke,a(G,{underline:!1,onClick:t[0]||(t[0]=o=>D("login"))},{default:n(()=>[h(" \u767B\u5F55"),a(m,{class:"el-icon--right"},{default:n(()=>[a(ce(pe))]),_:1})]),_:1})]),a(J,{ref_key:"formRef",ref:C,model:l,"status-icon":"",rules:R,"label-width":"84px","hide-required-asterisk":""},{default:n(()=>[a(g,{label:"\u624B\u673A\u53F7\u7801",prop:"phone"},{default:n(()=>[a(f,{modelValue:l.phone,"onUpdate:modelValue":t[1]||(t[1]=o=>l.phone=o),type:"text",placeholder:"\u4EE5\u540E\u53EF\u4EE5\u7528\u624B\u673A\u53F7\u767B\u5F55"},null,8,["modelValue"])]),_:1}),a(S,{modelValue:u.value,"onUpdate:modelValue":t[5]||(t[5]=o=>u.value=o),title:"\u56FE\u7247\u9A8C\u8BC1\u7801"},{default:n(()=>[a(g,{label:"\u56FE\u7247\u9A8C\u8BC1\u7801",prop:"captcha"},{default:n(()=>[e("div",we,[a(f,{modelValue:l.captcha,"onUpdate:modelValue":t[2]||(t[2]=o=>l.captcha=o),type:"text",placeholder:"\u8BF7\u8F93\u5165\u56FE\u7247\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),$.value?(v(),j(ve,{key:0,onGetCaptcha:t[3]||(t[3]=o=>L(o))})):V("",!0)])]),_:1}),a(k,{type:"primary",onClick:t[4]||(t[4]=o=>{u.value=!1,b()})},{default:n(()=>[h("\u4FDD\u5B58")]),_:1})]),_:1},8,["modelValue"]),N.value==1?(v(),j(g,{key:0,label:"\u77ED\u4FE1\u9A8C\u8BC1\u7801",prop:"code"},{default:n(()=>[e("div",Ve,[a(f,{modelValue:l.code,"onUpdate:modelValue":t[6]||(t[6]=o=>l.code=o),placeholder:"\u8BF7\u586B\u5199\u77ED\u4FE1\u9A8C\u8BC1\u7801"},null,8,["modelValue"]),a(k,{type:"primary",disabled:r.posting,onClick:b},{default:n(()=>[h(ie(F.value),1)]),_:1},8,["disabled"])])]),_:1})):V("",!0),a(g,{label:"\u8BBE\u7F6E\u5BC6\u7801",prop:"pass"},{default:n(()=>[a(f,{modelValue:l.pass,"onUpdate:modelValue":t[7]||(t[7]=o=>l.pass=o),"show-password":"",type:"password",placeholder:"8-16\u4F4D\u5FC5\u987B\u5305\u542B\u6570\u5B57\u548C\u5B57\u6BCD"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),e("div",Ce,[a(k,{type:"primary",onClick:t[8]||(t[8]=o=>A(C.value))},{default:n(()=>[h("\u6CE8\u518C")]),_:1})]),M.value==1?(v(),T("div",be,[Ue,e("div",{class:"otherLogin"},[e("div",{onClick:O,class:"item"})])])):V("",!0)])]),_:1}),a(S,{modelValue:_.value,"onUpdate:modelValue":t[9]||(t[9]=o=>_.value=o),title:"\u5FAE\u4FE1\u767B\u5F55",width:"360px"},{default:n(()=>[e("div",qe,[e("div",Ee,[e("div",Se,[a(X,{class:"qrcode lightBorder",src:U.value},null,8,["src"])]),Te])])]),_:1},8,["modelValue"])])}}};export{Le as default};
