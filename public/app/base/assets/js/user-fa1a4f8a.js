import{r as a,a as T,e as $,E as z,g as A,f as L,R as M,h as W,k as u,l as p,m as e,F as G,n as H,p as l,q as i,t as J,v as m,x as E,s as g,A as r,D as K}from"./index-8160da6b.js";import{p as O,a as Q,b as X,c as Y,d as Z,e as ee}from"./el-image-viewer-21b4c183.js";const se={class:"topTabStyle"},te={class:"tabStyleChild",style:{width:"160px"}},ae=["onClick"],le={class:"user-blo"},oe={key:0},ne={style:{display:"flex","justify-content":"flex-start"}},ie={key:1,class:"user-flex-2"},re=e("div",{class:"user-flexl"},[e("div",{class:"item-user"}),e("div",null,[e("div",null,"\u5FAE\u4FE1"),e("div",{style:{color:"#999","font-size":"14px"}},"\u7ED1\u5B9A\u5FAE\u4FE1\u8D26\u53F7\u540E\uFF0C\u60A8\u53EF\u4F7F\u7528\u5FAE\u4FE1\u8D26\u53F7\u767B\u5F55\u7F51\u7AD9")])],-1),de={class:"loginPanel normalPanel"},ue={class:"waiting panelContent"},ce={class:"wrp_code"},_e=e("div",{class:"info"},[e("div",{class:"status status_browser js_status js_wx_default_tip",id:"wx_default_tip"},[e("p",null,"\u4F7F\u7528\u5FAE\u4FE1\u626B\u4E00\u626B\u7ED1\u5B9A")]),e("div",{class:"status status_succ js_status js_wx_after_scan",style:{display:"none"},id:"wx_after_scan"},[e("i",{class:"status_icon icon38_msg succ"}),e("div",{class:"status_txt"},[e("h4",null,"\u626B\u63CF\u6210\u529F"),e("p",null,"\u5728\u5FAE\u4FE1\u4E2D\u8F7B\u89E6\u5141\u8BB8\u5373\u53EF\u767B\u5F55")])]),e("div",{class:"status status_fail js_status js_wx_after_cancel",style:{display:"none"},id:"wx_after_cancel"},[e("i",{class:"status_icon icon38_msg warn"}),e("div",{class:"status_txt"},[e("h4",null,"\u4F60\u5DF2\u53D6\u6D88\u6B64\u6B21\u767B\u5F55"),e("p",null,"\u4F60\u53EF\u518D\u6B21\u626B\u63CF\u767B\u5F55\uFF0C\u6216\u5173\u95ED\u7A97\u53E3")])])],-1),he={__name:"user",setup(pe){const d=a(0),F=a([{id:1,name:"\u624B\u673A\u7ED1\u5B9A"},{id:2,name:"\u5FAE\u4FE1\u7ED1\u5B9A"}]),c=a(0),t=T({phone:"",verfiy:""}),b=a(""),y=a(!1),v=a(!1),h=async()=>{const s=await O();s&&(b.value=s.data.telephone,s.data.telephone?y.value=!0:y.value=!1,s.data.wxopenid?v.value=!0:v.value=!1,c.value=1)},j=s=>{c.value=s.id};let x=null;const I=async()=>{var s=/^0?1[3|4|5|6|7|8][0-9]\d{8}$/;if(t.phone){if(!s.test(t.phone)){r.error("\u8BF7\u5148\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801");return}}else{r.error("\u8BF7\u5148\u8F93\u5165\u624B\u673A\u53F7\u7801");return}await Q({phone:t.phone})&&(d.value=60,x=setInterval(()=>{d.value==0?(clearInterval(x),x=null):d.value--},1e3))},S=async()=>{var s=/^0?1[3|4|5|6|7|8][0-9]\d{8}$/;if(t.phone){if(!s.test(t.phone)){r.error("\u8BF7\u5148\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u7801");return}}else{r.error("\u8BF7\u5148\u8F93\u5165\u624B\u673A\u53F7\u7801");return}if(!t.verfiy){r.error("\u8BF7\u5148\u8F93\u5165\u9A8C\u8BC1\u7801");return}await X(t)&&r.success("\u7ED1\u5B9A\u6210\u529F")},D=a(),U=a([]),_=a(!1),k=a({random:""}),C=a(""),N=async()=>{if(v.value){await Y()&&(r.success("\u89E3\u7ED1\u6210\u529F"),h());return}const s=await Z();s&&(C.value=s.data.code,k.value.random=s.data.random,_.value=!0,V())},V=async()=>{setTimeout(async()=>{await ee({random:k.value.random})?(r({message:"\u7ED1\u5B9A\u6210\u529F",type:"success"}),_.value=!1,h()):_.value&&V()},1e3)};return h(),(s,o)=>{const f=$,B=z,w=A,P=L,R=M,q=W;return u(),p("div",null,[e("div",se,[e("div",te,[(u(!0),p(G,null,H(F.value,(n,ve)=>(u(),p("div",{class:K({tabSelect:n.id===c.value}),onClick:fe=>j(n)},m(n.name),11,ae))),256))])]),e("div",le,[c.value==1?(u(),p("div",oe,[l(P,{style:{width:"600px"},ref_key:"ruleFormRef",ref:D,model:t,rules:U.value,"label-width":"120px",class:"demo-ruleForm","status-icon":""},{default:i(()=>[y.value?(u(),J(f,{key:0,label:"\u5F53\u524D\u624B\u673A"},{default:i(()=>[e("div",null,m(b.value),1)]),_:1})):E("",!0),l(f,{label:"\u65B0\u624B\u673A\u53F7"},{default:i(()=>[l(B,{style:{width:"400px"},modelValue:t.phone,"onUpdate:modelValue":o[0]||(o[0]=n=>t.phone=n)},null,8,["modelValue"])]),_:1}),l(f,{label:"\u9A8C\u8BC1\u7801"},{default:i(()=>[e("div",ne,[l(B,{style:{width:"400px"},modelValue:t.verfiy,"onUpdate:modelValue":o[1]||(o[1]=n=>t.verfiy=n)},null,8,["modelValue"]),l(w,{style:{"margin-left":"14px"},type:"primary",disabled:d.value!=0,onClick:I},{default:i(()=>[g(m(d.value==0?"\u83B7\u53D6\u9A8C\u8BC1\u7801":d.value+"s"),1)]),_:1},8,["disabled"])])]),_:1}),l(f,{label:""},{default:i(()=>[l(w,{type:"primary",onClick:S},{default:i(()=>[g("\u786E\u8BA4")]),_:1})]),_:1})]),_:1},8,["model","rules"])])):c.value==2?(u(),p("div",ie,[re,l(w,{style:{width:"90px"},type:"primary",onClick:N},{default:i(()=>[g(m(v.value?"\u89E3\u7ED1\u5FAE\u4FE1":"\u7ED1\u5B9A\u5FAE\u4FE1"),1)]),_:1})])):E("",!0)]),l(q,{modelValue:_.value,"onUpdate:modelValue":o[2]||(o[2]=n=>_.value=n),title:"\u5FAE\u4FE1\u7ED1\u5B9A",width:"360px"},{default:i(()=>[e("div",de,[e("div",ue,[e("div",ce,[l(R,{class:"qrcode lightBorder",src:C.value},null,8,["src"])]),_e])])]),_:1},8,["modelValue"])])}}};export{he as default};
