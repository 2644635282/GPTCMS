(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-wechatLogin-wechatLogin"],{1762:function(e,t,n){"use strict";n.r(t);var a=n("a1c4"),c=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t["default"]=c.a},a1c4:function(e,t,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c975"),n("ac1f"),n("466d"),n("e9c4"),n("caad"),n("2532"),n("5319");var c=a(n("c7eb")),i=a(n("1da1")),r={data:function(){return{}},onLoad:function(){var e=this;return(0,i.default)((0,c.default)().mark((function t(){var n,a;return(0,c.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.removeStorageSync("clitoken"),-1!=window.location.href.indexOf("code")?(n=uni.getStorageSync("inviteId")||"",uni.setStorageSync("inviteId",""),a=window.location.href.match(/code=(\S*)&/)[1],e.$u.api.userWechatLogin({code:a,parent:n}).then(function(){var t=(0,i.default)((0,c.default)().mark((function t(n){return(0,c.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return uni.setStorageSync("clitoken",n.data.token),t.next=3,e.getUserId();case 3:e.getRemindData(),e.afterLogin();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){alert("userWechatLogin: ".concat(JSON.stringify(e)))}))):e.getCode();case 2:case"end":return t.stop()}}),t)})))()},methods:{afterLogin:function(){var e=this.$mp.query.redirect;if(e){var t=decodeURIComponent(e);if(!t.includes("/pages/index/index"))return void location.replace(t)}uni.switchTab({url:"/pages/index/index"})},getUserId:function(){var e=this;return(0,i.default)((0,c.default)().mark((function t(){return(0,c.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$u.api.userInfo().then((function(e){localStorage.setItem("userId",e.data.id)})).catch((function(e){alert("userInfo: ".concat(JSON.stringify(e)))}));case 1:case"end":return t.stop()}}),t)})))()},getRemindData:function(){var e=this;return(0,i.default)((0,c.default)().mark((function t(){return(0,c.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$u.api.configRemind().then((function(e){e&&uni.setStorageSync("welcome",e.data.welcome)})).catch((function(e){alert("configRemind: ".concat(JSON.stringify(e)))}));case 1:case"end":return t.stop()}}),t)})))()},getCode:function(){var e=this;return(0,i.default)((0,c.default)().mark((function t(){var n;return(0,c.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n="",e.$u.api.configWechat().then((function(e){e&&e.data&&(n=e.data.appid);var t=encodeURIComponent(window.location.href);window.location.href="https://mp.yunzd.cn/connect/oauth2/authorize?appid="+n+"&redirect_uri="+t+"&response_type=code&connect_redirect=1&scope=snsapi_base&state=STATE#wechat_redirect"})).catch((function(e){alert("configWechat: ".concat(JSON.stringify(e)))}));case 2:case"end":return t.stop()}}),t)})))()}}};t.default=r},b3cb:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticClass:"s-back"})},c=[]},e0c1:function(e,t,n){"use strict";n.r(t);var a=n("b3cb"),c=n("1762");for(var i in c)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return c[e]}))}(i);var r=n("f0c5"),o=Object(r["a"])(c["default"],a["b"],a["c"],!1,null,"82cc65ae",null,!1,a["a"],void 0);t["default"]=o.exports}}]);